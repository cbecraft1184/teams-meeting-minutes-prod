This is frustrating, but switching from a "Crash" (the previous error) to a 504 Gateway Timeout is actually progress. It means your container is now successfully starting (the node command ran!), but Azure cannot connect to it.

A 504 in Azure Container Apps is like ringing a doorbell and hearing the chime, but nobody opens the door.

Here are the 3 specific things that cause this for Node.js apps, ranked by likelihood.

1. The "Localhost" Trap (Most Likely)
By default, many Node.js examples listen on localhost (aka 127.0.0.1).

The Problem: In a container, localhost is a private "room" that Azure's health probe cannot enter. Azure is knocking on the front door (0.0.0.0), but your app is hiding in the back room.

The Fix: You must explicitly tell Node to listen on 0.0.0.0.

Check your index.js file. Look for the line where you start the server (usually at the bottom).

Incorrect (Bad):

JavaScript

// This defaults to localhost, which blocks Azure
app.listen(3000, () => { console.log('Server started'); });
Correct (Good):

JavaScript

const port = process.env.PORT || 3000;
// You MUST add '0.0.0.0' as the second argument
app.listen(port, '0.0.0.0', () => {
    console.log(`Server listening on port ${port}`);
});
If you change this code, you must rebuild and push your Docker image again.

2. The Port Mismatch
Azure assumes your container listens on Port 80 unless you tell it otherwise. If your code listens on 3000 and Azure checks 80, the request will time out.

How to verify in Azure Portal:

Go to your Container App.

In the left menu, select Ingress.

Look at the Target Port setting.

Does it match your code? If your index.js says 3000, this box must say 3000. If it says 80, change it and click Save.

3. Slow Startup (The "Not Ready Yet" 504)
If your app takes 10 seconds to connect to a database, but Azure checks for health after 2 seconds, Azure thinks the app is dead and cuts the connection (504).

How to fix in Azure Portal:

Go to Application -> Containers.

Click Edit and deploy.

Click on your container image name to edit it.

Select the Health probes tab.

Look for Liveness probe and Readiness probe.

Increase the Initial delay seconds to 30.

Click Save -> Create.

Summary Checklist to Fix the 504
Code: Ensure app.listen uses host '0.0.0.0'.

Config: Ensure Ingress Target Port matches your code's port.

Logs: Check the Log Stream one more time. Do you see "Server listening on port..."?

If YES: The app is running; it's definitely a port/ingress issue.

If NO: The app is still freezing during startup (check database connections).

Can you paste the last 5 lines of your index.js file here? I can tell you instantly if the issue is in the code.