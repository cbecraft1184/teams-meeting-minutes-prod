christopher [ ~/TeamsMeetingDemo ]$ cd ~/TeamsMeetingDemo

# 1. Create Dockerfile
cat > Dockerfile << 'DOCKERFILE_END'
FROM node:22-alpine AS builder
WORKDIR /app
RUN apk add --no-cache python3 make g++
COPY package*.json ./
RUN npm install
RUN npx update-browserslist-db@latest --no-update-notifier || true
COPY . .
RUN node scripts/build-server.mjs

FROM node:22-alpine
WORKDIR /app
RUN apk add --no-cache curl ca-certificates python3 make g++
COPY package*.json ./
RUN npm install --omit=dev --include=optional --loglevel=error 2>&1 | grep -v "npm notice" | grep -v "npm warn" || true
COPY --from=builder /app/dist ./dist
COPY --from=builder /app/shared ./shared
COPY --from=builder /app/server ./server
COPY --from=builder /app/drizzle.config.ts ./drizzle.config.ts
COPY --from=builder /app/config ./config
COPY --from=builder /app/teams-app ./teams-app
EXPOSE 8080
ENV NODE_ENV=production
ENV PORT=8080
HEALTHCHECK --interval=30s --timeout=3s --start-period=40s --retries=3 \
  CMD curl -f http://localhost:${PORT:-8080}/health || exit 1
CMD ["node", "dist/index.js"]
DOCKERFILE_END

# 2. Create build script  
cat > scripts/build-server.mjs << 'BUILD_SCRIPT_END'
#!/usr/bin/env node
import { execSync } from 'child_process';
console.log('Building frontend with Vite...');
execSync('npx vite build', { stdio: 'inherit' });
console.log('Building server with esbuild (tree-shaking dev dependencies)...');
execSync(
  'npx esbuild server/index.ts --platform=node --bundle --define:process.env.NODE_ENV=\'"production"\' --external:vite --packages=external --format=esm --outdir=dist',
  { stdio: 'inherit' }
);
console.log('✅ Build complete!');
BUILD_SCRIPT_END

# 3. Create server/static.ts
cat > server/static.ts << 'STATIC_END'
echo "✅ Created 3 key files. Now I need to add the rest of the source files..." to build the client first`);
✅ Created 3 key files. Now I need to add the rest of the source files...
christopher [ ~/TeamsMeetingDemo ]$ 